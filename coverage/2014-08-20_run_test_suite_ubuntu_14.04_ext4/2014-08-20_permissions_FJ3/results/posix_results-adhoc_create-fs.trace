###########################################
# Testing mkdir and creating files
###########################################

# these tests create parent-directories with various permissions and
# then try to create files and directories inside these parent
# directories.  This should only work, if one has search and 
# write permission to the parent dir. However, the search permission
# is also needed needed for path resolution. The tests therefore also
# try to create the files in the current working directory. 
# before removing x permission.


# rwx
mkdir /tmp_dir_rwx/ 0o777
Tau
RV_none

chdir /tmp_dir_rwx
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir_rwx/ 0o700
Tau
RV_none


mkdir d1 0o777
Tau
RV_none

mkdir d2 0o777
Tau
EEXIST

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST

mkdir /tmp_dir_rwx/d3 0o777
Tau
RV_none

mkdir /tmp_dir_rwx/d4 0o777
Tau
EEXIST

open_close /tmp_dir_rwx/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close /tmp_dir_rwx/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST



# rw_
mkdir /tmp_dir_rw_/ 0o777
Tau
RV_none

chdir /tmp_dir_rw_
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir_rw_/ 0o600
Tau
RV_none


mkdir d1 0o777
Tau
EACCES

mkdir d2 0o777
Tau
EACCES

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

mkdir /tmp_dir_rw_/d3 0o777
Tau
EACCES

mkdir /tmp_dir_rw_/d4 0o777
Tau
EACCES

open_close /tmp_dir_rw_/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close /tmp_dir_rw_/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES



# r_x
mkdir /tmp_dir_r_x/ 0o777
Tau
RV_none

chdir /tmp_dir_r_x
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir_r_x/ 0o500
Tau
RV_none


mkdir d1 0o777
Tau
EACCES

mkdir d2 0o777
Tau
EEXIST

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST

mkdir /tmp_dir_r_x/d3 0o777
Tau
EACCES

mkdir /tmp_dir_r_x/d4 0o777
Tau
EEXIST

open_close /tmp_dir_r_x/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close /tmp_dir_r_x/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST



# r__
mkdir /tmp_dir_r__/ 0o777
Tau
RV_none

chdir /tmp_dir_r__
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir_r__/ 0o400
Tau
RV_none


mkdir d1 0o777
Tau
EACCES

mkdir d2 0o777
Tau
EACCES

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

mkdir /tmp_dir_r__/d3 0o777
Tau
EACCES

mkdir /tmp_dir_r__/d4 0o777
Tau
EACCES

open_close /tmp_dir_r__/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close /tmp_dir_r__/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES




# _wx
mkdir /tmp_dir__wx/ 0o777
Tau
RV_none

chdir /tmp_dir__wx
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir__wx/ 0o300
Tau
RV_none


mkdir d1 0o777
Tau
RV_none

mkdir d2 0o777
Tau
EEXIST

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST

mkdir /tmp_dir__wx/d3 0o777
Tau
RV_none

mkdir /tmp_dir__wx/d4 0o777
Tau
EEXIST

open_close /tmp_dir__wx/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close /tmp_dir__wx/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST




# _w_
mkdir /tmp_dir__w_/ 0o777
Tau
RV_none

chdir /tmp_dir__w_
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir__w_/ 0o200
Tau
RV_none


mkdir d1 0o777
Tau
EACCES

mkdir d2 0o777
Tau
EACCES

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

mkdir /tmp_dir__w_/d3 0o777
Tau
EACCES

mkdir /tmp_dir__w_/d4 0o777
Tau
EACCES

open_close /tmp_dir__w_/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close /tmp_dir__w_/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES



# __x
mkdir /tmp_dir___x/ 0o777
Tau
RV_none

chdir /tmp_dir___x
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir___x/ 0o100
Tau
RV_none


mkdir d1 0o777
Tau
EACCES

mkdir d2 0o777
Tau
EEXIST

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST

mkdir /tmp_dir___x/d3 0o777
Tau
EACCES

mkdir /tmp_dir___x/d4 0o777
Tau
EEXIST

open_close /tmp_dir___x/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close /tmp_dir___x/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EEXIST



# ___
mkdir /tmp_dir____/ 0o777
Tau
RV_none

chdir /tmp_dir____
Tau
RV_none

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

open_close f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
RV_none

mkdir d2 0o777
Tau
RV_none

mkdir d4 0o777
Tau
RV_none

chmod /tmp_dir____/ 0o000
Tau
RV_none


mkdir d1 0o777
Tau
EACCES

mkdir d2 0o777
Tau
EACCES

open_close f1 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close f2 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

mkdir /tmp_dir____/d3 0o777
Tau
EACCES

mkdir /tmp_dir____/d4 0o777
Tau
EACCES

open_close /tmp_dir____/f3 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

open_close /tmp_dir____/f4 [O_EXCL;O_CREAT;O_RDWR] 0o666
Tau
EACCES

