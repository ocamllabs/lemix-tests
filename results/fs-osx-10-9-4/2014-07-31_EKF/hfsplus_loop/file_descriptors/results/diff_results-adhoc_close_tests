        # Tests for close

        # close on an fd that was never used
     4: close (FD 3)
        Tau
        EBADF


        # and again
     7: close (FD 4)
        Tau
        EBADF


        # open a normal file, and close
    10: open f1.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:     10: open f1.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:     10: open f1.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    11: write (FD 3) "0123456789" 10
        Tau
        RV_num(10)

Error:     11: write (FD 3) "0123456789" 10
               Tau
               RV_num(10)
   unexpected results: RV_num(10)
   allowed are only: EBADF
   continuing execution with EBADF

    12: close (FD 3)
        Tau
        RV_none

Error:     12: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # open a normal file, and close twice
    15: open f2.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:     15: open f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:     15: open f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    16: close (FD 3)
        Tau
        RV_none

Error:     16: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

    17: close (FD 3)
        Tau
        EBADF


        # open and close a recently closed fd
    20: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:     20: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    21: close (FD 3)
        Tau
        RV_none

Error:     21: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


    23: open f1 [O_RDONLY]
        Tau
        ENOENT

    24: close (FD 3)
        Tau
        EBADF



        # multiple overlapping opens
    28: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:     28: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    29: open f2.txt [O_RDONLY]
        Tau
        RV_num(4)

Error:     29: open f2.txt [O_RDONLY]
               Tau
               RV_num(4)
   unexpected results: RV_num(4)
   allowed are only: ENOENT
   continuing execution with ENOENT

    30: close (FD 3)
        Tau
        RV_none

Error:     30: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

    31: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:     31: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    32: close (FD 4)
        Tau
        RV_none

Error:     32: close (FD 4)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

    33: close (FD 3)
        Tau
        RV_none

Error:     33: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF



        # opening a directory
    37: mkdir d1 0o755
        Tau
        RV_none

    38: open d1 [O_RDONLY]
        Tau
        EISDIR

Error:     38: open d1 [O_RDONLY]
               Tau
               EISDIR
   unexpected results: EISDIR
   allowed are only: RV_num(3)
   continuing execution with RV_num(3)

    39: close (FD 3)
        Tau
        EBADF

Error:     39: close (FD 3)
               Tau
               EBADF
   unexpected results: EBADF
   allowed are only: RV_none
   continuing execution with RV_none

    40: open d1 [O_RDONLY]
        Tau
        EISDIR

Error:     40: open d1 [O_RDONLY]
               Tau
               EISDIR
   unexpected results: EISDIR
   allowed are only: RV_num(3)
   continuing execution with RV_num(3)

    41: close (FD 3)
        Tau
        EBADF

Error:     41: close (FD 3)
               Tau
               EBADF
   unexpected results: EBADF
   allowed are only: RV_none
   continuing execution with RV_none


        # closing stdin
    44: close (FD 0)
        Tau
        RV_none


        # FIXME we can't close stdout because we are using it to return results of tests!
        # close (FD 1)

        # FIXME we probably shouldn't close stderr either
        # close (FD 2)


trace not accepted
