        # Tests for open and close

        ##############################################
        # basic cases that should work
        ##############################################

        # create a file with some content
     8: open f1.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:      8: open f1.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:      8: open f1.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

     9: write (FD 3) "0123456789" 10
        Tau
        RV_num(10)

Error:      9: write (FD 3) "0123456789" 10
               Tau
               RV_num(10)
   unexpected results: RV_num(10)
   allowed are only: EBADF
   continuing execution with EBADF

    10: close (FD 3)
        Tau
        RV_none

Error:     10: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # read that file again
    13: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:     13: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    14: read (FD 3) 100
        Tau
        RV_bytes("0123456789")

Error:     14: read (FD 3) 100
               Tau
               RV_bytes("0123456789")
   unexpected results: RV_bytes("0123456789")
   allowed are only: EBADF
   continuing execution with EBADF

    15: close (FD 3)
        Tau
        RV_none

Error:     15: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # read-write 
    18: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:     18: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    19: write (FD 3) "ABCDE" 5
        Tau
        RV_num(5)

Error:     19: write (FD 3) "ABCDE" 5
               Tau
               RV_num(5)
   unexpected results: RV_num(5)
   allowed are only: EBADF
   continuing execution with EBADF

    20: lseek (FD 3) 0 SEEK_SET
        Tau
        RV_num(0)

Error:     20: lseek (FD 3) 0 SEEK_SET
               Tau
               RV_num(0)
   unexpected results: RV_num(0)
   allowed are only: EBADF
   continuing execution with EBADF

    21: read (FD 3) 100
        Tau
        RV_bytes("ABCDE56789")

Error:     21: read (FD 3) 100
               Tau
               RV_bytes("ABCDE56789")
   unexpected results: RV_bytes("ABCDE56789")
   allowed are only: EBADF
   continuing execution with EBADF

    22: close (FD 3)
        Tau
        RV_none

Error:     22: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # write only on existing file
    25: open f1.txt [O_EXEC]
        Tau
        RV_num(3)

Error:     25: open f1.txt [O_EXEC]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    26: write (FD 3) "012" 3
        Tau
        RV_num(3)

Error:     26: write (FD 3) "012" 3
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

    27: close (FD 3)
        Tau
        RV_none

Error:     27: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # read that file again
    30: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:     30: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    31: read (FD 3) 100
        Tau
        RV_bytes("012DE56789")

Error:     31: read (FD 3) 100
               Tau
               RV_bytes("012DE56789")
   unexpected results: RV_bytes("012DE56789")
   allowed are only: EBADF
   continuing execution with EBADF

    32: close (FD 3)
        Tau
        RV_none

Error:     32: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # open for execute 
    35: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:     35: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    36: read (FD 3) 100
        Tau
        RV_bytes("012DE56789")

Error:     36: read (FD 3) 100
               Tau
               RV_bytes("012DE56789")
   unexpected results: RV_bytes("012DE56789")
   allowed are only: EBADF
   continuing execution with EBADF

    37: close (FD 3)
        Tau
        RV_none

Error:     37: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF



    40: mkdir d1 0o755
        Tau
        RV_none


        # open directory for searching
    43: open d1 [O_RDONLY]
        Tau
        RV_num(3)

    44: read (FD 3) 100
        Tau
        EISDIR

    45: close (FD 3)
        Tau
        RV_none



        ##############################################
        # opening problems with 
        # non-existing files and dirs
        ##############################################

    53: open non-such-file.txt [O_RDONLY]
        Tau
        ENOENT

    54: read (FD 3) 100
        Tau
        EBADF

    55: close (FD 3)
        Tau
        EBADF


    57: open /no_such_dir/non-such-file.txt [O_RDONLY]
        Tau
        ENOENT

    58: read (FD 3) 100
        Tau
        EBADF

    59: close (FD 3)
        Tau
        EBADF


    61: open non-such-dir/ [O_RDONLY]
        Tau
        ENOENT

    62: read (FD 3) 100
        Tau
        EBADF

    63: close (FD 3)
        Tau
        EBADF


    65: open /no_such_dir/non-such-dir2/ [O_RDONLY]
        Tau
        ENOENT

    66: read (FD 3) 100
        Tau
        EBADF

    67: close (FD 3)
        Tau
        EBADF


        # opening an existing file with a slash at the end
    70: open f1.txt/ [O_RDONLY]
        Tau
        ENOTDIR

Error:     70: open f1.txt/ [O_RDONLY]
               Tau
               ENOTDIR
   unexpected results: ENOTDIR
   allowed are only: ENOENT
   continuing execution with ENOENT

    71: read (FD 3) 100
        Tau
        EBADF

    72: close (FD 3)
        Tau
        EBADF



        ##############################################
        # O_CREAT
        ##############################################

        # create without write flag is fine. It create
        # a file (if it does not exist before), but
        # we can only read from it
    82: open f1.txt [O_RDONLY;O_EXCL] 0o644
        Tau

Error:     82: open f1.txt [O_RDONLY;O_EXCL] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:     82: open f1.txt [O_RDONLY;O_EXCL] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    83: write (FD 3) "ABCDE" 5
        Tau
        EBADF

    84: read (FD 3) 100
        Tau
        RV_bytes("012DE56789")

Error:     84: read (FD 3) 100
               Tau
               RV_bytes("012DE56789")
   unexpected results: RV_bytes("012DE56789")
   allowed are only: EBADF
   continuing execution with EBADF

    85: close (FD 3)
        Tau
        RV_none

Error:     85: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


    87: open f2.txt [O_RDONLY;O_EXCL] 0o644
        Tau

Error:     87: open f2.txt [O_RDONLY;O_EXCL] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:     87: open f2.txt [O_RDONLY;O_EXCL] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    88: write (FD 3) "ABCDE" 5
        Tau
        EBADF

    89: pread (FD 3) 100 0
        Tau
        RV_bytes("")

Error:     89: pread (FD 3) 100 0
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

    90: close (FD 3)
        Tau
        RV_none

Error:     90: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

    91: unlink f2.txt
        Tau
        RV_none

Error:     91: unlink f2.txt
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


        # if O_EXCL is given the file must not exist
    94: open f1.txt [O_NOCTTY;O_EXCL;O_RDONLY] 0o644
        Tau

Error:     94: open f1.txt [O_NOCTTY;O_EXCL;O_RDONLY] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        EEXIST

Error:     94: open f1.txt [O_NOCTTY;O_EXCL;O_RDONLY] 0o644
               Tau
               EEXIST
   unexpected results: EEXIST
   allowed are only: ENOENT
   continuing execution with ENOENT

    95: close (FD 3)
        Tau
        EBADF


    97: open f2.txt [O_NOCTTY;O_EXCL;O_RDONLY] 0o644
        Tau

Error:     97: open f2.txt [O_NOCTTY;O_EXCL;O_RDONLY] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:     97: open f2.txt [O_NOCTTY;O_EXCL;O_RDONLY] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

    98: write (FD 3) "ABCDE" 5
        Tau
        RV_num(5)

Error:     98: write (FD 3) "ABCDE" 5
               Tau
               RV_num(5)
   unexpected results: RV_num(5)
   allowed are only: EBADF
   continuing execution with EBADF

    99: pread (FD 3) 100 0
        Tau
        RV_bytes("ABCDE")

Error:     99: pread (FD 3) 100 0
               Tau
               RV_bytes("ABCDE")
   unexpected results: RV_bytes("ABCDE")
   allowed are only: EBADF
   continuing execution with EBADF

   100: close (FD 3)
        Tau
        RV_none

Error:    100: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

   101: unlink f2.txt
        Tau
        RV_none

Error:    101: unlink f2.txt
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


        # if O_EXCL but not O_CREATE is set, the result is undefined
        # open f1.txt [O_RDWR;O_EXCL] 0o777
        # close (FD 3)

        # to create a file, we need write access to the parent dir
        #chmod /d1 r-xr-xr-x
   109: open /d1/f3.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:    109: open /d1/f3.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:    109: open /d1/f3.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   110: close (FD 3)
        Tau
        RV_none

Error:    110: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        #chmod /d1 rwxr-xr-x
   113: open /d1/f3.txt [O_EXCL;O_RDONLY] 0o644
        Tau

Error:    113: open /d1/f3.txt [O_EXCL;O_RDONLY] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:    113: open /d1/f3.txt [O_EXCL;O_RDONLY] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   114: write (FD 3) "ABCDE" 5
        Tau
        RV_num(5)

Error:    114: write (FD 3) "ABCDE" 5
               Tau
               RV_num(5)
   unexpected results: RV_num(5)
   allowed are only: EBADF
   continuing execution with EBADF

   115: pread (FD 3) 100 0
        Tau
        RV_bytes("ABCDE")

Error:    115: pread (FD 3) 100 0
               Tau
               RV_bytes("ABCDE")
   unexpected results: RV_bytes("ABCDE")
   allowed are only: EBADF
   continuing execution with EBADF

   116: close (FD 3)
        Tau
        RV_none

Error:    116: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

   117: unlink /d1/f3.txt
        Tau
        RV_none

Error:    117: unlink /d1/f3.txt
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


        # the file-permissions of a newly created file don't matter
   120: open /d1/f3.txt [O_EXCL;O_RDONLY] 0o444
        Tau

Error:    120: open /d1/f3.txt [O_EXCL;O_RDONLY] 0o444
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:    120: open /d1/f3.txt [O_EXCL;O_RDONLY] 0o444
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   121: write (FD 3) "ABCDE" 5
        Tau
        RV_num(5)

Error:    121: write (FD 3) "ABCDE" 5
               Tau
               RV_num(5)
   unexpected results: RV_num(5)
   allowed are only: EBADF
   continuing execution with EBADF

   122: pread (FD 3) 100 0
        Tau
        RV_bytes("ABCDE")

Error:    122: pread (FD 3) 100 0
               Tau
               RV_bytes("ABCDE")
   unexpected results: RV_bytes("ABCDE")
   allowed are only: EBADF
   continuing execution with EBADF

   123: close (FD 3)
        Tau
        RV_none

Error:    123: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   125: open /d1/f3.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    125: open /d1/f3.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   126: close (FD 3)
        Tau
        RV_none

Error:    126: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   128: open /d1/f3.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    128: open /d1/f3.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   129: read (FD 3) 100
        Tau
        RV_bytes("ABCDE")

Error:    129: read (FD 3) 100
               Tau
               RV_bytes("ABCDE")
   unexpected results: RV_bytes("ABCDE")
   allowed are only: EBADF
   continuing execution with EBADF

   130: close (FD 3)
        Tau
        RV_none

Error:    130: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # open does not change the permissions on existing files
   133: open /d1/f3.txt [O_RDONLY;O_EXCL] 0o000
        Tau

Error:    133: open /d1/f3.txt [O_RDONLY;O_EXCL] 0o000
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:    133: open /d1/f3.txt [O_RDONLY;O_EXCL] 0o000
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   134: pread (FD 3) 100 0
        Tau
        RV_bytes("ABCDE")

Error:    134: pread (FD 3) 100 0
               Tau
               RV_bytes("ABCDE")
   unexpected results: RV_bytes("ABCDE")
   allowed are only: EBADF
   continuing execution with EBADF

   135: close (FD 3)
        Tau
        RV_none

Error:    135: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   137: open /d1/f3.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    137: open /d1/f3.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   138: read (FD 3) 100
        Tau
        RV_bytes("ABCDE")

Error:    138: read (FD 3) 100
               Tau
               RV_bytes("ABCDE")
   unexpected results: RV_bytes("ABCDE")
   allowed are only: EBADF
   continuing execution with EBADF

   139: close (FD 3)
        Tau
        RV_none

Error:    139: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

   140: unlink /d1/f3.txt
        Tau
        RV_none

Error:    140: unlink /d1/f3.txt
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


        # not even read permission is needed on newly created files
   143: open /d1/f3.txt [O_RDONLY;O_EXCL] 0o000
        Tau

Error:    143: open /d1/f3.txt [O_RDONLY;O_EXCL] 0o000
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:    143: open /d1/f3.txt [O_RDONLY;O_EXCL] 0o000
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   144: pread (FD 3) 100 0
        Tau
        RV_bytes("")

Error:    144: pread (FD 3) 100 0
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   145: close (FD 3)
        Tau
        RV_none

Error:    145: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   147: open /d1/f3.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    147: open /d1/f3.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   148: read (FD 3) 100
        Tau
        RV_bytes("")

Error:    148: read (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   149: close (FD 3)
        Tau
        RV_none

Error:    149: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

   150: unlink /d1/f3.txt
        Tau
        RV_none

Error:    150: unlink /d1/f3.txt
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT



        # O_CREAT flag only creates files not the dirs in path
   154: open /no-such-dir/file.txt [O_RDONLY;O_EXCL] 0o644
        Tau

Error:    154: open /no-such-dir/file.txt [O_RDONLY;O_EXCL] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        ENOENT

   155: close (FD 3)
        Tau
        EBADF



        # creating a file without providing a mode is
        # unspecified in Posix. For Linux, the
        # default mode is 0o101
   161: open f2.txt [O_EXCL;O_EXEC]
        Tau

Error:    161: open f2.txt [O_EXCL;O_EXEC]
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:    161: open f2.txt [O_EXCL;O_EXEC]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   162: close (FD 3)
        Tau
        RV_none

Error:    162: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF

   163: stat f2.txt
        Tau
        { st_dev=16777220; st_ino=60; st_kind=S_IFREG; st_perm=0o105; st_nlink=1; st_uid=-1; st_gid=-1; st_rdev=0; st_size=0; }

Error:    163: stat f2.txt
               Tau
               { st_dev=16777220; st_ino=60; st_kind=S_IFREG; st_perm=0o105; st_nlink=1; st_uid=-1; st_gid=-1; st_rdev=0; st_size=0; }
   unexpected results: { st_dev=16777220; st_ino=60; st_kind=S_IFREG; st_perm=0o105; st_nlink=1; st_uid=-1; st_gid=-1; st_rdev=0; st_size=0; }
   allowed are only: ENOENT
   continuing execution with ENOENT

   164: unlink f2.txt
        Tau
        RV_none

Error:    164: unlink f2.txt
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


        ##############################################
        # O_TRUNC
        ##############################################

        # O_TRUNC works as expected
   171: unlink f1.txt
        Tau
        RV_none

Error:    171: unlink f1.txt
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   172: open f1.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:    172: open f1.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_num(3)

Error:    172: open f1.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   173: write! (FD 3) "0123456789" 10
        Tau
        RV_num(10)

Error:    173: write! (FD 3) "0123456789" 10
               Tau
               RV_num(10)
   unexpected results: RV_num(10)
   allowed are only: EBADF
   continuing execution with EBADF

   174: close (FD 3)
        Tau
        RV_none

Error:    174: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   176: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    176: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   177: read! (FD 3) 100
        Tau
        RV_bytes("0123456789")

Error:    177: read! (FD 3) 100
               Tau
               RV_bytes("0123456789")
   unexpected results: RV_bytes("0123456789")
   allowed are only: EBADF
   continuing execution with EBADF

   178: close (FD 3)
        Tau
        RV_none

Error:    178: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   180: open f1.txt [O_APPEND;O_RDONLY]
        Tau
        RV_num(3)

Error:    180: open f1.txt [O_APPEND;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   181: read! (FD 3) 100
        Tau
        RV_bytes("")

Error:    181: read! (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   182: close (FD 3)
        Tau
        RV_none

Error:    182: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # behaviour of O_TRUNC without write flag is undefined
        # on linux architecture, the O_TRUNC just truncates 
        # even in read-only mode
   187: open f1.txt [O_APPEND;O_RDONLY]
        Tau
        RV_num(3)

Error:    187: open f1.txt [O_APPEND;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   188: write! (FD 3) "0123456789" 10
        Tau
        RV_num(10)

Error:    188: write! (FD 3) "0123456789" 10
               Tau
               RV_num(10)
   unexpected results: RV_num(10)
   allowed are only: EBADF
   continuing execution with EBADF

   189: close (FD 3)
        Tau
        RV_none

Error:    189: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   191: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    191: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   192: read! (FD 3) 100
        Tau
        RV_bytes("0123456789")

Error:    192: read! (FD 3) 100
               Tau
               RV_bytes("0123456789")
   unexpected results: RV_bytes("0123456789")
   allowed are only: EBADF
   continuing execution with EBADF

   193: close (FD 3)
        Tau
        RV_none

Error:    193: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   195: open f1.txt [O_RDONLY;O_APPEND]
        Tau
        RV_num(3)

Error:    195: open f1.txt [O_RDONLY;O_APPEND]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   196: read! (FD 3) 100
        Tau
        RV_bytes("")

Error:    196: read! (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   197: close (FD 3)
        Tau
        RV_none

Error:    197: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # but we can't truncate file we don't have write permission to
   200: open f1.txt [O_APPEND;O_RDONLY]
        Tau
        RV_num(3)

Error:    200: open f1.txt [O_APPEND;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   201: write (FD 3) "0123456789" 10
        Tau
        RV_num(10)

Error:    201: write (FD 3) "0123456789" 10
               Tau
               RV_num(10)
   unexpected results: RV_num(10)
   allowed are only: EBADF
   continuing execution with EBADF

   202: close (FD 3)
        Tau
        RV_none

Error:    202: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   204: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    204: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   205: read! (FD 3) 100
        Tau
        RV_bytes("0123456789")

Error:    205: read! (FD 3) 100
               Tau
               RV_bytes("0123456789")
   unexpected results: RV_bytes("0123456789")
   allowed are only: EBADF
   continuing execution with EBADF

   206: close (FD 3)
        Tau
        RV_none

Error:    206: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   208: chmod f1.txt 0o444
        Tau
        RV_none

Error:    208: chmod f1.txt 0o444
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   209: open f1.txt [O_RDONLY;O_APPEND]
        Tau
        RV_num(3)

Error:    209: open f1.txt [O_RDONLY;O_APPEND]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   210: read! (FD 3) 100
        Tau
        RV_bytes("")

Error:    210: read! (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   211: close (FD 3)
        Tau
        RV_none

Error:    211: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   213: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    213: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   214: read! (FD 3) 100
        Tau
        RV_bytes("")

Error:    214: read! (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   215: close (FD 3)
        Tau
        RV_none

Error:    215: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   217: chmod f1.txt 0o644
        Tau
        RV_none

Error:    217: chmod f1.txt 0o644
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   218: open f1.txt [O_RDONLY;O_APPEND]
        Tau
        RV_num(3)

Error:    218: open f1.txt [O_RDONLY;O_APPEND]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   219: read! (FD 3) 100
        Tau
        RV_bytes("")

Error:    219: read! (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   220: close (FD 3)
        Tau
        RV_none

Error:    220: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   222: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    222: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   223: read! (FD 3) 100
        Tau
        RV_bytes("")

Error:    223: read! (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   224: close (FD 3)
        Tau
        RV_none

Error:    224: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF



        ##############################################
        # O_DIRECTORY
        ##############################################

        # using O_DIRECTORY with dirs is fine
        # but we can't do anything afterwards :-)
   233: open d1 [O_RDONLY;O_CLOEXEC]
        Tau
        RV_num(3)

   234: read (FD 3) 100
        Tau
        EISDIR

   235: close (FD 3)
        Tau
        RV_none


        # using O_DIRECTORY with files fails
   238: open f1.txt [O_RDONLY;O_CLOEXEC]
        Tau
        RV_num(3)

Error:    238: open f1.txt [O_RDONLY;O_CLOEXEC]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   239: read (FD 3) 100
        Tau
        RV_bytes("")

Error:    239: read (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   240: close (FD 3)
        Tau
        RV_none

Error:    240: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # using O_DIRECTORY on non-existing files
   243: open no-such-file.txt [O_RDONLY;O_CLOEXEC]
        Tau
        ENOENT

   244: read (FD 3) 100
        Tau
        EBADF

   245: close (FD 3)
        Tau
        EBADF


        # using O_DIRECTORY on non-existing dir
   248: open /no-such-dir/ [O_RDONLY;O_CLOEXEC]
        Tau
        ENOENT

   249: read (FD 3) 100
        Tau
        EBADF

   250: close (FD 3)
        Tau
        EBADF


        # we can't create directories
   253: open /no-such-dir/ [O_RDONLY;O_EXCL;O_CLOEXEC]
        Tau

Error:    253: open /no-such-dir/ [O_RDONLY;O_EXCL;O_CLOEXEC]
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        ENOENT

   254: read (FD 3) 100
        Tau
        EBADF

   255: close (FD 3)
        Tau
        EBADF


   257: open /no-such-dir/ [O_RDONLY;O_EXCL]
        Tau

Error:    257: open /no-such-dir/ [O_RDONLY;O_EXCL]
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        ENOENT

   258: read (FD 3) 100
        Tau
        EBADF

   259: close (FD 3)
        Tau
        EBADF



        ##############################################
        # O_APPEND
        ##############################################

        # write fresh content
   267: open f1.txt [O_APPEND;O_RDONLY]
        Tau
        RV_num(3)

Error:    267: open f1.txt [O_APPEND;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   268: write! (FD 3) "0123456789" 10
        Tau
        RV_num(10)

Error:    268: write! (FD 3) "0123456789" 10
               Tau
               RV_num(10)
   unexpected results: RV_num(10)
   allowed are only: EBADF
   continuing execution with EBADF

   269: pread! (FD 3) 100 0
        Tau
        RV_bytes("0123456789")

Error:    269: pread! (FD 3) 100 0
               Tau
               RV_bytes("0123456789")
   unexpected results: RV_bytes("0123456789")
   allowed are only: EBADF
   continuing execution with EBADF

   270: close (FD 3)
        Tau
        RV_none

Error:    270: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # override at beginning
   273: open f1.txt [O_RDONLY]
        Tau
        RV_num(3)

Error:    273: open f1.txt [O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   274: write (FD 3) "ABCDE" 5
        Tau
        RV_num(5)

Error:    274: write (FD 3) "ABCDE" 5
               Tau
               RV_num(5)
   unexpected results: RV_num(5)
   allowed are only: EBADF
   continuing execution with EBADF

   275: pread! (FD 3) 100 0
        Tau
        RV_bytes("ABCDE56789")

Error:    275: pread! (FD 3) 100 0
               Tau
               RV_bytes("ABCDE56789")
   unexpected results: RV_bytes("ABCDE56789")
   allowed are only: EBADF
   continuing execution with EBADF

   276: close (FD 3)
        Tau
        RV_none

Error:    276: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # override at end
   279: open f1.txt [O_NONBLOCK;O_RDONLY]
        Tau
        RV_num(3)

Error:    279: open f1.txt [O_NONBLOCK;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   280: write (FD 3) "ABCDE" 5
        Tau
        RV_num(5)

Error:    280: write (FD 3) "ABCDE" 5
               Tau
               RV_num(5)
   unexpected results: RV_num(5)
   allowed are only: EBADF
   continuing execution with EBADF

   281: pread! (FD 3) 100 0
        Tau
        RV_bytes("ABCDE56789ABCDE")

Error:    281: pread! (FD 3) 100 0
               Tau
               RV_bytes("ABCDE56789ABCDE")
   unexpected results: RV_bytes("ABCDE56789ABCDE")
   allowed are only: EBADF
   continuing execution with EBADF

   282: close (FD 3)
        Tau
        RV_none

Error:    282: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # O_APPEND sets file-offset before every(!) write
   285: open f1.txt [O_NONBLOCK;O_RDONLY]
        Tau
        RV_num(3)

Error:    285: open f1.txt [O_NONBLOCK;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   286: write (FD 3) "XXX" 3
        Tau
        RV_num(3)

Error:    286: write (FD 3) "XXX" 3
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

   287: lseek (FD 3) 0 SEEK_SET
        Tau
        RV_num(0)

Error:    287: lseek (FD 3) 0 SEEK_SET
               Tau
               RV_num(0)
   unexpected results: RV_num(0)
   allowed are only: EBADF
   continuing execution with EBADF

   288: write (FD 3) "YYY" 3
        Tau
        RV_num(3)

Error:    288: write (FD 3) "YYY" 3
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

   289: lseek (FD 3) 0 SEEK_SET
        Tau
        RV_num(0)

Error:    289: lseek (FD 3) 0 SEEK_SET
               Tau
               RV_num(0)
   unexpected results: RV_num(0)
   allowed are only: EBADF
   continuing execution with EBADF

   290: write (FD 3) "ZZZ" 3
        Tau
        RV_num(3)

Error:    290: write (FD 3) "ZZZ" 3
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

   291: read (FD 3) 100
        Tau
        RV_bytes("")

Error:    291: read (FD 3) 100
               Tau
               RV_bytes("")
   unexpected results: RV_bytes("")
   allowed are only: EBADF
   continuing execution with EBADF

   292: lseek (FD 3) 0 SEEK_SET
        Tau
        RV_num(0)

Error:    292: lseek (FD 3) 0 SEEK_SET
               Tau
               RV_num(0)
   unexpected results: RV_num(0)
   allowed are only: EBADF
   continuing execution with EBADF

   293: read (FD 3) 100
        Tau
        RV_bytes("ABCDE56789ABCDEXXXYYYZZZ")

Error:    293: read (FD 3) 100
               Tau
               RV_bytes("ABCDE56789ABCDEXXXYYYZZZ")
   unexpected results: RV_bytes("ABCDE56789ABCDEXXXYYYZZZ")
   allowed are only: EBADF
   continuing execution with EBADF

   294: pread! (FD 3) 100 0
        Tau
        RV_bytes("ABCDE56789ABCDEXXXYYYZZZ")

Error:    294: pread! (FD 3) 100 0
               Tau
               RV_bytes("ABCDE56789ABCDEXXXYYYZZZ")
   unexpected results: RV_bytes("ABCDE56789ABCDEXXXYYYZZZ")
   allowed are only: EBADF
   continuing execution with EBADF

   295: close (FD 3)
        Tau
        RV_none

Error:    295: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # O_APPEND also affects pwrite
   298: open f1.txt [O_NONBLOCK;O_RDONLY]
        Tau
        RV_num(3)

Error:    298: open f1.txt [O_NONBLOCK;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   299: pwrite (FD 3) "AAA" 3 0
        Tau
        RV_num(3)

Error:    299: pwrite (FD 3) "AAA" 3 0
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

   300: pwrite (FD 3) "BBB" 3 -1
        Tau
        EINVAL

Error:    300: pwrite (FD 3) "BBB" 3 -1
               Tau
               EINVAL
   unexpected results: EINVAL
   allowed are only: EBADF
   continuing execution with EBADF

   301: pwrite (FD 3) "CCC" 3 5
        Tau
        RV_num(3)

Error:    301: pwrite (FD 3) "CCC" 3 5
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

   302: pread! (FD 3) 100 0
        Tau
        RV_bytes("AAADECCC89ABCDEXXXYYYZZZ")

Error:    302: pread! (FD 3) 100 0
               Tau
               RV_bytes("AAADECCC89ABCDEXXXYYYZZZ")
   unexpected results: RV_bytes("AAADECCC89ABCDEXXXYYYZZZ")
   allowed are only: EBADF
   continuing execution with EBADF

   303: close (FD 3)
        Tau
        RV_none

Error:    303: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


        # pwrite does not modify fd-offset, whereas write does
   306: open f1.txt [O_NONBLOCK;O_RDONLY]
        Tau
        RV_num(3)

Error:    306: open f1.txt [O_NONBLOCK;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   307: lseek (FD 3) 0 SEEK_CUR
        Tau
        RV_num(0)

Error:    307: lseek (FD 3) 0 SEEK_CUR
               Tau
               RV_num(0)
   unexpected results: RV_num(0)
   allowed are only: EBADF
   continuing execution with EBADF

   308: pwrite (FD 3) "DDD" 3 0
        Tau
        RV_num(3)

Error:    308: pwrite (FD 3) "DDD" 3 0
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

   309: lseek (FD 3) 0 SEEK_CUR
        Tau
        RV_num(0)

Error:    309: lseek (FD 3) 0 SEEK_CUR
               Tau
               RV_num(0)
   unexpected results: RV_num(0)
   allowed are only: EBADF
   continuing execution with EBADF

   310: write (FD 3) "EEE" 3
        Tau
        RV_num(3)

Error:    310: write (FD 3) "EEE" 3
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: EBADF
   continuing execution with EBADF

   311: lseek (FD 3) 0 SEEK_CUR
        Tau
        RV_num(27)

Error:    311: lseek (FD 3) 0 SEEK_CUR
               Tau
               RV_num(27)
   unexpected results: RV_num(27)
   allowed are only: EBADF
   continuing execution with EBADF

   312: pread! (FD 3) 100 0
        Tau
        RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")

Error:    312: pread! (FD 3) 100 0
               Tau
               RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")
   unexpected results: RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")
   allowed are only: EBADF
   continuing execution with EBADF

   313: close (FD 3)
        Tau
        RV_none

Error:    313: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF



        # O_APPEND does only influence write and pwrite
   317: open f1.txt [O_NONBLOCK;O_RDONLY]
        Tau
        RV_num(3)

Error:    317: open f1.txt [O_NONBLOCK;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   318: read (FD 3) 100
        Tau
        RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")

Error:    318: read (FD 3) 100
               Tau
               RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")
   unexpected results: RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")
   allowed are only: EBADF
   continuing execution with EBADF

   319: close (FD 3)
        Tau
        RV_none

Error:    319: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   321: open f1.txt [O_NONBLOCK;O_RDONLY]
        Tau
        RV_num(3)

Error:    321: open f1.txt [O_NONBLOCK;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   322: pread (FD 3) 100 0
        Tau
        RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")

Error:    322: pread (FD 3) 100 0
               Tau
               RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")
   unexpected results: RV_bytes("DDDDECCC89ABCDEXXXYYYZZZEEE")
   allowed are only: EBADF
   continuing execution with EBADF

   323: close (FD 3)
        Tau
        RV_none

Error:    323: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF


   325: open f1.txt [O_NONBLOCK;O_RDONLY]
        Tau
        RV_num(3)

Error:    325: open f1.txt [O_NONBLOCK;O_RDONLY]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   326: lseek (FD 3) 0 SEEK_CUR
        Tau
        RV_num(0)

Error:    326: lseek (FD 3) 0 SEEK_CUR
               Tau
               RV_num(0)
   unexpected results: RV_num(0)
   allowed are only: EBADF
   continuing execution with EBADF

   327: close (FD 3)
        Tau
        RV_none

Error:    327: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF



        ##############################################
        # testing file permissions
        ##############################################

        # read-only needs read permission
   335: chmod f1.txt 0o400
        Tau
        RV_none

Error:    335: chmod f1.txt 0o400
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   336: open_close f1.txt [O_RDONLY]
        Tau
        RV_none

Error:    336: open_close f1.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   338: chmod f1.txt 0o000
        Tau
        RV_none

Error:    338: chmod f1.txt 0o000
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   339: open_close f1.txt [O_RDONLY]
        Tau
        RV_none

Error:    339: open_close f1.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT



        # write-only needs write permission
   343: chmod f1.txt 0o200
        Tau
        RV_none

Error:    343: chmod f1.txt 0o200
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   344: open_close f1.txt [O_EXEC]
        Tau
        RV_none

Error:    344: open_close f1.txt [O_EXEC]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   346: chmod f1.txt 0o000
        Tau
        RV_none

Error:    346: chmod f1.txt 0o000
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   347: open_close f1.txt [O_EXEC]
        Tau
        RV_none

Error:    347: open_close f1.txt [O_EXEC]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   349: chmod f1.txt 0o400
        Tau
        RV_none

Error:    349: chmod f1.txt 0o400
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   350: open_close f1.txt [O_EXEC]
        Tau
        RV_none

Error:    350: open_close f1.txt [O_EXEC]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


        # read-write needs read and write permission
   353: chmod f1.txt 0o600
        Tau
        RV_none

Error:    353: chmod f1.txt 0o600
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   354: open_close f1.txt [O_RDONLY]
        Tau
        RV_none

Error:    354: open_close f1.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   356: chmod f1.txt 0o400
        Tau
        RV_none

Error:    356: chmod f1.txt 0o400
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   357: open_close f1.txt [O_RDONLY]
        Tau
        RV_none

Error:    357: open_close f1.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   359: chmod f1.txt 0o200
        Tau
        RV_none

Error:    359: chmod f1.txt 0o200
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   360: open_close f1.txt [O_RDONLY]
        Tau
        RV_none

Error:    360: open_close f1.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   362: chmod f1.txt 0o000
        Tau
        RV_none

Error:    362: chmod f1.txt 0o000
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   363: open_close f1.txt [O_RDONLY]
        Tau
        RV_none

Error:    363: open_close f1.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT



        # truncate requires write permission
   367: chmod f1.txt 0o600
        Tau
        RV_none

Error:    367: chmod f1.txt 0o600
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   368: open_close f1.txt [O_RDONLY;O_APPEND]
        Tau
        RV_none

Error:    368: open_close f1.txt [O_RDONLY;O_APPEND]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   370: chmod f1.txt 0o400
        Tau
        RV_none

Error:    370: chmod f1.txt 0o400
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   371: open_close f1.txt [O_RDONLY;O_APPEND]
        Tau
        RV_none

Error:    371: open_close f1.txt [O_RDONLY;O_APPEND]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT



        # append makes only sense with write, but 
        # does not require it
   376: chmod f1.txt 0o400
        Tau
        RV_none

Error:    376: chmod f1.txt 0o400
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT

   377: open f1.txt [O_RDONLY;O_NONBLOCK]
        Tau
        RV_num(3)

Error:    377: open f1.txt [O_RDONLY;O_NONBLOCK]
               Tau
               RV_num(3)
   unexpected results: RV_num(3)
   allowed are only: ENOENT
   continuing execution with ENOENT

   378: write (FD 3) "0123456789" 10
        Tau
        EBADF

   379: close (FD 3)
        Tau
        RV_none

Error:    379: close (FD 3)
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: EBADF
   continuing execution with EBADF



        ##############################################
        # testing dir permissions
        ##############################################

        # creating a file needs search and write permission
        # to the parent directory
   388: chmod d1 0o000
        Tau
        RV_none

   389: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:    389: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_none

Error:    389: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   391: chmod d1 0o200
        Tau
        RV_none

   392: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:    392: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_none

Error:    392: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   394: chmod d1 0o100
        Tau
        RV_none

   395: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:    395: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_none

Error:    395: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   397: chmod d1 0o300
        Tau
        RV_none

   398: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
        Tau

Error:    398: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
   special states found:
     - OS_special (Undefined, "open: O_EXCL, no O_CREAT, posix/open.md D:1")
   continuing with normal result states
        RV_none

Error:    398: open_close d1/f2.txt [O_EXCL;O_EXEC] 0o644
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT



        # to read a file, we needs search permission for the
        # parent directory (as well as to the file itself)

   404: chmod d1 0o000
        Tau
        RV_none

   405: open_close d1/f2.txt [O_RDONLY]
        Tau
        RV_none

Error:    405: open_close d1/f2.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   407: chmod d1 0o100
        Tau
        RV_none

   408: open_close d1/f2.txt [O_RDONLY]
        Tau
        RV_none

Error:    408: open_close d1/f2.txt [O_RDONLY]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT



        # search permission to the parent is enough to modify a file
   412: chmod d1 0o000
        Tau
        RV_none

   413: open_close d1/f2.txt [O_EXEC]
        Tau
        RV_none

Error:    413: open_close d1/f2.txt [O_EXEC]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


   415: chmod d1 0o100
        Tau
        RV_none

   416: open_close d1/f2.txt [O_EXEC]
        Tau
        RV_none

Error:    416: open_close d1/f2.txt [O_EXEC]
               Tau
               RV_none
   unexpected results: RV_none
   allowed are only: ENOENT
   continuing execution with ENOENT


        # clean-up for dump etc.
   419: chmod d1 0o700
        Tau
        RV_none


trace not accepted
